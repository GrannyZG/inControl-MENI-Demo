<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crestron Elegance – House Overview</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="vendor/feather.min.js"></script>
    <script src="components/navbar.js"></script>
</head>
<body class="bg-gray-900 text-white h-screen w-screen overflow-hidden flex">
    <custom-navbar></custom-navbar>

    <main class="flex-1 p-6">
        <div class="h-full bg-gradient-to-b from-gray-900 to-gray-950 rounded-3xl p-5 shadow-2xl border border-white/5 flex gap-6">
            
            <!-- LEFT: CATEGORY LIST -->
            <aside class="w-64 bg-gray-900/80 rounded-2xl p-4 flex flex-col gap-4 border border-white/5">
                <div class="flex items-center justify-between">
                    <h2 class="text-sm font-semibold text-gray-300 tracking-wide">House Overview</h2>
                    <button
                        onclick="window.location.href='index.html'"
                        class="text-[11px] px-3 py-1 rounded-full bg-gray-800 hover:bg-gray-700 border border-white/10"
                    >
                        Back
                    </button>
                </div>

                <div class="space-y-3">
                    <button
                        class="main-tab-btn is-open"
                        data-main-tab="functions"
                    >
                        <span class="flex items-center gap-2">
                            <i data-feather="layers" class="w-4 h-4"></i>
                            Functions
                        </span>
                        <span class="tab-chevron">⌄</span>
                    </button>
                    <div class="subtab-group" data-main-group="functions">
                        <button
                            class="function-btn flex items-center justify-between px-3 py-3 rounded-xl bg-indigo-600 text-sm font-medium shadow-lg shadow-indigo-900/40 border border-indigo-400/40"
                            data-target="lighting"
                        >
                            <span class="flex items-center gap-2">
                                <i data-feather="sun" class="w-4 h-4"></i>
                                Lighting
                            </span>
                            <span class="text-[11px] text-indigo-100/90">6 zones</span>
                        </button>

                        <button
                            class="function-btn flex items-center justify-between px-3 py-3 rounded-xl bg-gray-800/80 hover:bg-gray-700/90 text-sm font-medium border border-white/5"
                            data-target="blinds"
                        >
                            <span class="flex items-center gap-2">
                                <i data-feather="sliders" class="w-4 h-4"></i>
                                Blinds
                            </span>
                            <span class="text-[11px] text-gray-400">4 groups</span>
                        </button>

                        <button
                            class="function-btn flex items-center justify-between px-3 py-3 rounded-xl bg-gray-800/80 hover:bg-gray-700/90 text-sm font-medium border border-white/5"
                            data-target="climate"
                        >
                            <span class="flex items-center gap-2">
                                <i data-feather="thermometer" class="w-4 h-4"></i>
                                Climate
                            </span>
                            <span class="text-[11px] text-gray-400">4 zones</span>
                        </button>

                    </div>

            <button
                class="main-tab-btn"
                data-main-tab="floors"
            >
                <span class="flex items-center gap-2">
                    <i data-feather="map" class="w-4 h-4"></i>
                    Floors
                </span>
                <span class="tab-chevron">⌄</span>
            </button>
            <div class="subtab-group hidden" data-main-group="floors">
                <p class="text-[11px] text-gray-400 px-1 uppercase tracking-[0.2em]">Floors</p>
                <button
                    class="room-btn"
                    data-room="basement"
                    data-room-title="Basement"
                    data-room-detail="Cinema & storage"
                >
                    Basement
                </button>
                <button
                    class="room-btn"
                    data-room="ground"
                    data-room-title="Ground Floor"
                    data-room-detail="Kitchen & foyer"
                >
                    Ground Floor
                </button>
                <button
                    class="room-btn"
                    data-room="first"
                    data-room-title="1st Floor"
                    data-room-detail="Bedrooms & private suites"
                >
                    1st Floor
                </button>
                <button
                    class="room-btn"
                    data-room="roof"
                    data-room-title="Roof Terrace"
                    data-room-detail="Sky lounge"
                >
                    Roof
                </button>
                <button
                    class="room-btn"
                    data-room="outside"
                    data-room-title="Outside"
                    data-room-detail="Garden & pool"
                >
                    Outside
                </button>
            </div>
                </div>
            </aside>

            <!-- RIGHT: ACTIVE PANEL -->
            <section class="flex-1 bg-gray-900/80 rounded-2xl p-5 border border-white/5 flex flex-col overflow-hidden">
                <!-- Dynamic header -->
                <header id="panel-header" class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <div id="panel-icon" class="w-9 h-9 rounded-full bg-indigo-500/20 flex items-center justify-center">
                            <i data-feather="sun" class="w-4 h-4"></i>
                        </div>
                        <div>
                            <h1 id="panel-title" class="text-lg font-semibold">Lighting</h1>
                            <p id="panel-subtitle" class="text-xs text-gray-400">6 active zones · quick dimming</p>
                        </div>
                    </div>
                    <span class="text-[11px] px-3 py-1 rounded-full bg-gray-800 border border-white/10 text-gray-300">
                        Whole house · overview mode
                    </span>
                </header>

                <div class="h-px bg-gradient-to-r from-transparent via-white/10 to-transparent mb-4"></div>

                <!-- SCROLL AREA -->
                <div class="flex-1 overflow-y-auto pr-1 space-y-4">
                    <div id="panel-functions" class="space-y-4">

                    <!-- LIGHTING PANEL -->
                    <div id="panel-lighting" class="category-panel space-y-3">
                        <!-- dimmable -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Ceiling Spots</div>
                                <div class="text-[11px] text-gray-400 light-location">Master Bedroom · Visilica</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">75</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle is-on"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Ceiling Spots"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- non-dimmable -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Wall Sconces</div>
                                <div class="text-[11px] text-gray-400 light-location">Living Room</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                State: <span class="light-state font-semibold">OFF</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div
                                    class="light-toggle is-on"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="false"
                                    aria-label="Toggle Wall Sconces"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- dimmable -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Kitchen Worktop</div>
                                <div class="text-[11px] text-gray-400 light-location">Kitchen</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">50</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Kitchen Worktop"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- BASEMENT (00) – examples -->
                        <!-- dimmable (green) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Basement Main</div>
                                <div class="text-[11px] text-gray-400 light-location">Basement · Open Area</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">60</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Basement Main"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- dimmable (green) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Basement Cinema</div>
                                <div class="text-[11px] text-gray-400 light-location">Basement · Home Cinema</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">30</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Basement Cinema"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- non-dimmable (red) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Basement Stairs</div>
                                <div class="text-[11px] text-gray-400 light-location">Basement · Staircase</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                State: <span class="light-state font-semibold">OFF</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="false"
                                    aria-label="Toggle Basement Stairs"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- GROUND FLOOR (01) – examples -->
                        <!-- dimmable (green) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Living Spots</div>
                                <div class="text-[11px] text-gray-400 light-location">Ground Floor · Living Room</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">80</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Living Spots"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- non-dimmable (red) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Dining Pendant</div>
                                <div class="text-[11px] text-gray-400 light-location">Ground Floor · Dining</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                State: <span class="light-state font-semibold">OFF</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="false"
                                    aria-label="Toggle Dining Pendant"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- non-dimmable (red) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Hallway</div>
                                <div class="text-[11px] text-gray-400 light-location">Ground Floor · Corridor</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                State: <span class="light-state font-semibold">ON</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Hallway"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- FIRST FLOOR (02) – examples -->
                        <!-- dimmable (green) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Master Cove</div>
                                <div class="text-[11px] text-gray-400 light-location">First Floor · Master Bedroom</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">40</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Master Cove"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- dimmable (green) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Kids Ceiling</div>
                                <div class="text-[11px] text-gray-400 light-location">First Floor · Kids Room</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                Level: <span class="light-level font-semibold">70</span>%
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="true"
                                    aria-label="Toggle Kids Ceiling"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                                <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                    DIM
                                </button>
                            </div>
                        </div>

                        <!-- non-dimmable (red) -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                            <div>
                                <div class="text-sm font-semibold light-name">Bathroom Mirror</div>
                                <div class="text-[11px] text-gray-400 light-location">First Floor · Bathroom</div>
                            </div>
                            <div class="text-xs text-gray-300">
                                State: <span class="light-state font-semibold">OFF</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div
                                    class="light-toggle"
                                    data-light-toggle
                                    role="switch"
                                    aria-checked="false"
                                    aria-label="Toggle Bathroom Mirror"
                                    tabindex="0"
                                >
                                    <div class="toggle-track">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- BLINDS PANEL -->
                    <div id="panel-blinds" class="category-panel space-y-3 hidden">
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5">
                            <div>
                                <div class="text-sm font-semibold">Main Window</div>
                                <div class="text-[11px] text-gray-400">Living Room</div>
                            </div>
                            <div class="flex items-center gap-2">
                                <button class="text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center gap-1">
                                    <i data-feather="arrow-up" class="w-3 h-3"></i>
                                    UP
                                </button>
                                <button class="text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center gap-1">
                                    <i data-feather="arrow-down" class="w-3 h-3"></i>
                                    DOWN
                                </button>
                            </div>
                        </div>

                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5">
                            <div>
                                <div class="text-sm font-semibold">Terrace Door</div>
                                <div class="text-[11px] text-gray-400">Ground Floor</div>
                            </div>
                            <div class="flex items-center gap-2">
                                <button class="text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center gap-1">
                                    <i data-feather="arrow-up" class="w-3 h-3"></i>
                                    UP
                                </button>
                                <button class="text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center gap-1">
                                    <i data-feather="arrow-down" class="w-3 h-3"></i>
                                    DOWN
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- CLIMATE PANEL -->
                    <div id="panel-climate" class="category-panel space-y-3 hidden">
                        <!-- Zone 1 -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-climate-row data-current-temp="22" data-mode="heat">
                            <div class="flex items-center gap-3">
                                <div>
                                    <div class="text-sm font-semibold">Living Room</div>
                                    <div class="text-[11px] text-gray-400">Main thermostat</div>
                                </div>
                                <div class="text-xs text-gray-300">
                                    Current: <span class="font-semibold">22°C</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="text-xs text-gray-200">
                                    <div class="flex items-center gap-1">
                                        <span class="target-temp font-semibold">21.0</span>°C
                                        <span class="climate-icon flex"></span>
                                    </div>
                                    <div class="flex items-center gap-1 mt-1">
                                        <button class="climate-mode-btn active" data-mode="heat">Heat</button>
                                        <button class="climate-mode-btn" data-mode="cool">Cool</button>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <button class="btn-temp-down text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                        <i data-feather="minus" class="w-3 h-3"></i>
                                    </button>
                                    <button class="btn-temp-up text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                        <i data-feather="plus" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Zone 2 -->
                        <div class="bg-gray-800 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-climate-row data-current-temp="20" data-mode="heat">
                            <div class="flex items-center gap-3">
                                <div>
                                    <div class="text-sm font-semibold">Master Bedroom</div>
                                    <div class="text-[11px] text-gray-400">Radiator thermostat</div>
                                </div>
                                <div class="text-xs text-gray-300">
                                    Current: <span class="font-semibold">20°C</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="text-xs text-gray-200">
                                    <div class="flex items-center gap-1">
                                        <span class="target-temp font-semibold">19.0</span>°C
                                        <span class="climate-icon flex"></span>
                                    </div>
                                    <div class="flex items-center gap-1 mt-1">
                                        <button class="climate-mode-btn active" data-mode="heat">Heat</button>
                                        <button class="climate-mode-btn" data-mode="cool">Cool</button>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <button class="btn-temp-down text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                        <i data-feather="minus" class="w-3 h-3"></i>
                                    </button>
                                    <button class="btn-temp-up text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                        <i data-feather="plus" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    </div> <!-- end panel-functions -->

                    <!-- FLOORS PANEL -->
                    <div id="panel-floors" class="space-y-4 hidden">
                        <div id="floors-placeholder" class="bg-gray-800/80 border border-white/5 rounded-2xl p-6 text-center text-sm text-gray-400">
                            Select a floor from the tab to review local devices.
                        </div>

                        <div data-room-panel="basement" class="room-panel hidden space-y-4">
                            <div class="bg-gray-800/70 border border-white/5 rounded-2xl p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-sm font-semibold">Basement Lounge</h3>
                                        <p class="text-[11px] text-gray-400">Cinema · Ambient scenes</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                                        <div>
                                            <div class="text-sm font-semibold light-name">Ambient Strip</div>
                                            <div class="text-[11px] text-gray-400 light-location">Basement Lounge</div>
                                        </div>
                                        <div class="text-xs text-gray-300 light-meta">
                                            Level: <span class="light-level font-semibold">50</span>%
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="light-toggle is-on" data-light-toggle role="switch" aria-checked="true" tabindex="0">
                                                <div class="toggle-track">
                                                    <div class="toggle-thumb"></div>
                                                </div>
                                            </div>
                                            <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                                DIM
                                            </button>
                                        </div>
                                    </div>
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-climate-row data-current-temp="21" data-mode="heat">
                                        <div class="flex items-center gap-3">
                                            <div>
                                                <div class="text-sm font-semibold">Basement Thermostat</div>
                                                <div class="text-[11px] text-gray-400">VRV cassette</div>
                                            </div>
                                            <div class="text-xs text-gray-300">
                                                Current: <span class="font-semibold">21°C</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-4">
                                            <div class="text-xs text-gray-200">
                                                <div class="flex items-center gap-1">
                                                    <span class="target-temp font-semibold">20.0</span>°C
                                                    <span class="climate-icon flex"></span>
                                                </div>
                                                <div class="flex items-center gap-1 mt-1">
                                                    <button class="climate-mode-btn active" data-mode="heat">Heat</button>
                                                    <button class="climate-mode-btn" data-mode="cool">Cool</button>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <button class="btn-temp-down text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                    <i data-feather="minus" class="w-3 h-3"></i>
                                                </button>
                                                <button class="btn-temp-up text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                    <i data-feather="plus" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gray-800/70 border border-white/5 rounded-2xl p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-sm font-semibold">Storage Room</h3>
                                        <p class="text-[11px] text-gray-400">Utility · Lighting + climate</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                                        <div>
                                            <div class="text-sm font-semibold light-name">Shelf Lights</div>
                                            <div class="text-[11px] text-gray-400 light-location">Storage</div>
                                        </div>
                                        <div class="text-xs text-gray-300 light-meta">
                                            State: <span class="light-state font-semibold">ON</span>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="light-toggle is-on" data-light-toggle role="switch" aria-checked="true" tabindex="0">
                                                <div class="toggle-track">
                                                    <div class="toggle-thumb"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-climate-row data-current-temp="19" data-mode="heat">
                                        <div class="flex items-center gap-3">
                                            <div>
                                                <div class="text-sm font-semibold">Storage Thermostat</div>
                                                <div class="text-[11px] text-gray-400">Dehumidifier</div>
                                            </div>
                                            <div class="text-xs text-gray-300">
                                                Current: <span class="font-semibold">19°C</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-4">
                                            <div class="text-xs text-gray-200">
                                                <div class="flex items-center gap-1">
                                                    <span class="target-temp font-semibold">19.0</span>°C
                                                    <span class="climate-icon flex"></span>
                                                </div>
                                                <div class="flex items-center gap-1 mt-1">
                                                    <button class="climate-mode-btn active" data-mode="heat">Heat</button>
                                                    <button class="climate-mode-btn" data-mode="cool">Cool</button>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <button class="btn-temp-down text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                    <i data-feather="minus" class="w-3 h-3"></i>
                                                </button>
                                                <button class="btn-temp-up text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                    <i data-feather="plus" class="w-3 h-3"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div data-room-panel="ground" class="room-panel hidden space-y-4">
                            <div class="bg-gray-800/70 border border-white/5 rounded-2xl p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-sm font-semibold">Kitchen</h3>
                                        <p class="text-[11px] text-gray-400">Ground Floor · Task lighting</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                                        <div>
                                            <div class="text-sm font-semibold light-name">Ceiling Spots</div>
                                            <div class="text-[11px] text-gray-400 light-location">Kitchen</div>
                                        </div>
                                        <div class="text-xs text-gray-300 light-meta">
                                            Level: <span class="light-level font-semibold">35</span>%
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="light-toggle" data-light-toggle role="switch" aria-checked="false" tabindex="0">
                                                <div class="toggle-track">
                                                    <div class="toggle-thumb"></div>
                                                </div>
                                            </div>
                                            <button class="btn-light-dim text-xs px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                                                DIM
                                            </button>
                                        </div>
                                    </div>
                                    <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                                        <div>
                                            <div class="text-sm font-semibold light-name">Island Pendants</div>
                                            <div class="text-[11px] text-gray-400 light-location">Kitchen</div>
                                        </div>
                                        <div class="text-xs text-gray-300 light-meta">
                                            State: <span class="light-state font-semibold">ON</span>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="light-toggle is-on" data-light-toggle role="switch" aria-checked="true" tabindex="0">
                                                <div class="toggle-track">
                                                    <div class="toggle-thumb"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gray-800/70 border border-white/5 rounded-2xl p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-sm font-semibold">Kitchen · Climate</h3>
                                        <p class="text-[11px] text-gray-400">Radiant floor</p>
                                    </div>
                                </div>
                                <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-climate-row data-current-temp="22" data-mode="heat">
                                    <div class="flex items-center gap-3">
                                        <div>
                                            <div class="text-sm font-semibold">Kitchen Thermostat</div>
                                            <div class="text-[11px] text-gray-400">Floor loop</div>
                                        </div>
                                        <div class="text-xs text-gray-300">
                                            Current: <span class="font-semibold">22°C</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-4">
                                        <div class="text-xs text-gray-200">
                                            <div class="flex items-center gap-1">
                                                <span class="target-temp font-semibold">21.0</span>°C
                                                <span class="climate-icon flex"></span>
                                            </div>
                                            <div class="flex items-center gap-1 mt-1">
                                                <button class="climate-mode-btn active" data-mode="heat">Heat</button>
                                                <button class="climate-mode-btn" data-mode="cool">Cool</button>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <button class="btn-temp-down text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                <i data-feather="minus" class="w-3 h-3"></i>
                                            </button>
                                            <button class="btn-temp-up text-xs px-3 py-1 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center">
                                                <i data-feather="plus" class="w-3 h-3"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gray-800/70 border border-white/5 rounded-2xl p-4">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-sm font-semibold">Hallway</h3>
                                        <p class="text-[11px] text-gray-400">Entry & path</p>
                                    </div>
                                </div>
                                <div class="bg-gray-900/70 rounded-xl px-4 py-3 flex items-center justify-between border border-white/5" data-light-row>
                                    <div>
                                        <div class="text-sm font-semibold light-name">Hallway Sconces</div>
                                        <div class="text-[11px] text-gray-400 light-location">Foyer</div>
                                    </div>
                                    <div class="text-xs text-gray-300 light-meta">
                                        State: <span class="light-state font-semibold">ON</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="light-toggle is-on" data-light-toggle role="switch" aria-checked="true" tabindex="0">
                                            <div class="toggle-track">
                                                <div class="toggle-thumb"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div data-room-panel="first" class="room-panel hidden space-y-4">
                            <div class="bg-gray-800/70 border border-dashed border-white/10 rounded-2xl p-6 text-sm text-center text-gray-400">
                                Demo website · full content coming soon for this floor.
                            </div>
                        </div>

                        <div data-room-panel="roof" class="room-panel hidden space-y-4">
                            <div class="bg-gray-800/70 border border-dashed border-white/10 rounded-2xl p-6 text-sm text-center text-gray-400">
                                Demo website · full content coming soon for the roof terrace.
                            </div>
                        </div>

                        <div data-room-panel="outside" class="room-panel hidden space-y-4">
                            <div class="bg-gray-800/70 border border-dashed border-white/10 rounded-2xl p-6 text-sm text-center text-gray-400">
                                Demo website · full content coming soon for the outdoor zone.
                            </div>
                        </div>
                    </div>

                </div>
            </section>
        </div>
    </main>

    <!-- DIMMER MODAL -->
    <div id="dim-modal" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-50">
        <div class="bg-gray-900 rounded-2xl p-5 w-full max-w-xs border border-white/10 shadow-2xl">
            <h3 class="text-sm font-semibold mb-1">Adjust dimming level</h3>
            <p id="dim-modal-label" class="text-[11px] text-gray-400 mb-4">
                Ceiling Spots · Master Bedroom
            </p>
            <div class="mb-4">
                <div class="flex items-center justify-between text-xs mb-1">
                    <span>0%</span>
                    <span id="dim-value" class="font-semibold">75%</span>
                </div>
                <input
                    id="dim-slider"
                    type="range"
                    min="0"
                    max="100"
                    step="5"
                    value="75"
                    class="w-full"
                >
            </div>
            <div class="flex justify-end gap-2 text-xs">
                <button id="dim-cancel" class="px-3 py-1 rounded-full bg-gray-800 hover:bg-gray-700">
                    Cancel
                </button>
                <button id="dim-apply" class="px-3 py-1 rounded-full bg-indigo-600 hover:bg-indigo-700">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const functionButtons = document.querySelectorAll('.function-btn');
            const mainTabButtons = document.querySelectorAll('[data-main-tab]');
            const panels = {
                lighting: document.getElementById('panel-lighting'),
                blinds: document.getElementById('panel-blinds'),
                climate: document.getElementById('panel-climate')
            };
            const panelFunctions = document.getElementById('panel-functions');
            const panelFloors = document.getElementById('panel-floors');
            const roomButtons = document.querySelectorAll('.room-btn');
            const roomPanels = document.querySelectorAll('[data-room-panel]');
            const floorsPlaceholder = document.getElementById('floors-placeholder');
            const functionsGroup = document.querySelector('[data-main-group="functions"]');
            const floorsGroup = document.querySelector('[data-main-group="floors"]');
            const functionsTabBtn = document.querySelector('[data-main-tab="functions"]');
            const floorsTabBtn = document.querySelector('[data-main-tab="floors"]');
            const climateRows = document.querySelectorAll('[data-climate-row]');

            const headerIcon = document.getElementById('panel-icon');
            const headerTitle = document.getElementById('panel-title');
            const headerSubtitle = document.getElementById('panel-subtitle');
            let activeMainTab = 'functions';
            let activeFunctionTarget = 'lighting';
            let activeRoom = null;

            function setHeaderFor(target) {
                if (!headerIcon || !headerTitle || !headerSubtitle) return;

                if (target === 'lighting') {
                    headerIcon.innerHTML = '<i data-feather="sun" class="w-4 h-4"></i>';
                    headerTitle.textContent = 'Lighting';
                    headerSubtitle.textContent = '6 active zones · quick dimming';
                } else if (target === 'blinds') {
                    headerIcon.innerHTML = '<i data-feather="sliders" class="w-4 h-4"></i>';
                    headerTitle.textContent = 'Blinds';
                    headerSubtitle.textContent = '4 groups · privacy & daylight';
                } else if (target === 'climate') {
                    headerIcon.innerHTML = '<i data-feather="thermometer" class="w-4 h-4"></i>';
                    headerTitle.textContent = 'Climate';
                    headerSubtitle.textContent = '4 zones · comfort overview';
                } else if (target === 'floors') {
                    headerIcon.innerHTML = '<i data-feather="map" class="w-4 h-4"></i>';
                    headerTitle.textContent = 'Floors';
                    headerSubtitle.textContent = 'Select a room to view devices';
                }
            }

            function setHeaderForRoom(name, detail) {
                if (!headerIcon || !headerTitle || !headerSubtitle) return;
                headerIcon.innerHTML = '<i data-feather="home" class="w-4 h-4"></i>';
                headerTitle.textContent = name || 'Room';
                headerSubtitle.textContent = detail || 'Room devices overview';
            }

            function openMainGroup(target) {
                const btn = target === 'functions' ? functionsTabBtn : floorsTabBtn;
                const group = target === 'functions' ? functionsGroup : floorsGroup;
                if (btn && !btn.classList.contains('is-open')) {
                    btn.classList.add('is-open');
                    if (group) group.classList.remove('hidden');
                }
            }

            function setFunctionButtonState(target) {
                functionButtons.forEach(btn => {
                    const isActive = btn.dataset.target === target;
                    btn.classList.toggle('bg-indigo-600', isActive);
                    btn.classList.toggle('shadow-lg', isActive);
                    btn.classList.toggle('shadow-indigo-900/40', isActive);
                    btn.classList.toggle('border-indigo-400/40', isActive);
                    btn.classList.toggle('bg-gray-800/80', !isActive);
                    btn.classList.toggle('border-white/5', !isActive);
                });
            }

            function showFunctionPanel(target) {
                if (!target) return;
                Object.values(panels).forEach(p => p && p.classList.add('hidden'));
                const panel = panels[target];
                if (panel) panel.classList.remove('hidden');
                activeFunctionTarget = target;
                setFunctionButtonState(target);
                openMainGroup('functions');
                setActiveMainTab('functions');
                if (window.feather) feather.replace();
            }

            function setActiveMainTab(target) {
                activeMainTab = target;
                if (panelFunctions) panelFunctions.classList.toggle('hidden', target !== 'functions');
                if (panelFloors) panelFloors.classList.toggle('hidden', target !== 'floors');

                if (target === 'functions') {
                    setHeaderFor(activeFunctionTarget);
                } else if (target === 'floors') {
                    if (activeRoom) {
                        let title = 'Room';
                        let detail = 'Room devices overview';
                        roomButtons.forEach(btn => {
                            if (btn.dataset.room === activeRoom) {
                                title = btn.dataset.roomTitle || btn.textContent.trim();
                                detail = btn.dataset.roomDetail || detail;
                            }
                        });
                        setHeaderForRoom(title, detail);
                    } else {
                        if (floorsPlaceholder) floorsPlaceholder.classList.remove('hidden');
                        roomPanels.forEach(panel => panel.classList.add('hidden'));
                        setHeaderFor('floors');
                    }
                }
                if (window.feather) feather.replace();
            }

            function showRoomPanel(roomId) {
                if (!panelFloors) return;
                activeRoom = roomId;
                let foundBtn = null;

                roomPanels.forEach(panel => {
                    if (panel.dataset.roomPanel === roomId) {
                        panel.classList.remove('hidden');
                    } else {
                        panel.classList.add('hidden');
                    }
                });

                if (floorsPlaceholder) floorsPlaceholder.classList.add('hidden');

                roomButtons.forEach(btn => {
                    const isMatch = btn.dataset.room === roomId;
                    btn.classList.toggle('active', isMatch);
                    if (isMatch) foundBtn = btn;
                });

                const title = foundBtn ? (foundBtn.dataset.roomTitle || foundBtn.textContent.trim()) : 'Room';
                const detail = foundBtn ? (foundBtn.dataset.roomDetail || '') : '';
                setHeaderForRoom(title, detail);
                openMainGroup('floors');
                setActiveMainTab('floors');
                if (window.feather) feather.replace();
            }

            // MAIN TABS
            if (mainTabButtons.length > 0) {
                mainTabButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const target = btn.dataset.mainTab;
                        const group = target ? document.querySelector(`[data-main-group="${target}"]`) : null;
                        const isOpen = btn.classList.contains('is-open');

                        if (isOpen) {
                            btn.classList.remove('is-open');
                            if (group) group.classList.add('hidden');
                        } else {
                            mainTabButtons.forEach(other => {
                                if (other !== btn) {
                                    other.classList.remove('is-open');
                                    const otherGroup = document.querySelector(`[data-main-group="${other.dataset.mainTab}"]`);
                                    if (otherGroup) otherGroup.classList.add('hidden');
                                }
                            });
                            btn.classList.add('is-open');
                            if (group) group.classList.remove('hidden');
                        }

                        if (target) setActiveMainTab(target);
                    });
                });
            }

            // ROOM BUTTONS
            if (roomButtons.length > 0) {
                roomButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const roomId = btn.dataset.room;
                        if (!roomId) return;
                        openMainGroup('floors');
                        showRoomPanel(roomId);
                    });
                });
            }

            if (functionButtons.length > 0) {
                functionButtons.forEach(btn => {
                    btn.addEventListener('click', () => showFunctionPanel(btn.dataset.target));
                });
                showFunctionPanel('lighting');
            } else {
                setActiveMainTab('functions');
            }

            function refreshLightToggle(row, isOn) {
                const toggle = row ? row.querySelector('[data-light-toggle]') : null;
                if (!toggle) return;
                toggle.setAttribute('aria-checked', isOn ? 'true' : 'false');
                toggle.classList.toggle('is-on', isOn);
            }

            function updateLightState(row, isOn) {
                if (!row) return;
                const levelSpan = row.querySelector('.light-level');
                const stateSpan = row.querySelector('.light-state');

                if (levelSpan) {
                    if (isOn) {
                        let targetLevel = parseInt(row.dataset.lastLevel || levelSpan.textContent || '100', 10);
                        if (Number.isNaN(targetLevel) || targetLevel <= 0) targetLevel = 100;
                        levelSpan.textContent = targetLevel;
                    } else {
                        const currentLevel = parseInt(levelSpan.textContent, 10);
                        if (!Number.isNaN(currentLevel) && currentLevel > 0) {
                            row.dataset.lastLevel = currentLevel;
                        }
                        levelSpan.textContent = '0';
                    }
                }
                if (stateSpan) stateSpan.textContent = isOn ? 'ON' : 'OFF';
                refreshLightToggle(row, isOn);
            }

            function updateClimateModeButtons(row) {
                if (!row) return;
                const mode = row.dataset.mode || 'heat';
                row.querySelectorAll('.climate-mode-btn').forEach(btn => {
                    const isActive = btn.dataset.mode === mode;
                    btn.classList.toggle('active', isActive);
                });
            }

            function updateClimateStatus(row) {
                if (!row) return;
                const iconSlot = row.querySelector('.climate-icon');
                const targetSpan = row.querySelector('.target-temp');
                const mode = row.dataset.mode || 'heat';
                const current = parseFloat(row.dataset.currentTemp || '0');
                const target = parseFloat(targetSpan ? targetSpan.textContent : '0');
                const shouldHeat = mode === 'heat' && target >= current + 2;
                const shouldCool = mode === 'cool' && target <= current - 2;

                if (iconSlot) {
                    if (shouldHeat) {
                        iconSlot.innerHTML = '<i data-feather="activity" class="w-3 h-3 text-orange-400"></i>';
                    } else if (shouldCool) {
                        iconSlot.innerHTML = '<i data-feather="wind" class="w-3 h-3 text-sky-300"></i>';
                    } else {
                        iconSlot.innerHTML = '';
                    }
                }
                if (window.feather) feather.replace();
            }

            function setClimateMode(row, mode) {
                if (!row || !mode) return;
                row.dataset.mode = mode;
                updateClimateModeButtons(row);
                updateClimateStatus(row);
            }

            function adjustClimateTarget(btn, delta) {
                const row = btn.closest('[data-climate-row]');
                if (!row) return;
                const span = row.querySelector('.target-temp');
                if (!span) return;
                let val = parseFloat(span.textContent);
                if (Number.isNaN(val)) val = 0;
                val += delta;
                span.textContent = val.toFixed(1);
                updateClimateStatus(row);
            }

            // LIGHTING: ON/OFF + DIMMER
            const dimModal = document.getElementById('dim-modal');
            const dimSlider = document.getElementById('dim-slider');
            const dimValue = document.getElementById('dim-value');
            const dimLabel = document.getElementById('dim-modal-label');
            const dimCancel = document.getElementById('dim-cancel');
            const dimApply = document.getElementById('dim-apply');
            let currentDimRow = null;

            const overviewRoot = document;

            overviewRoot.addEventListener('click', (e) => {
                const toggle = e.target.closest('[data-light-toggle]');
                const dimBtn = e.target.closest('.btn-light-dim');

                if (toggle) {
                    const row = toggle.closest('[data-light-row]');
                    const isCurrentlyOn = toggle.getAttribute('aria-checked') === 'true';
                    updateLightState(row, !isCurrentlyOn);
                }

                if (dimBtn && dimModal && dimSlider && dimValue && dimLabel) {
                    const row = dimBtn.closest('[data-light-row]');
                    if (!row) return;
                    currentDimRow = row;

                    const nameEl = row.querySelector('.light-name');
                    const placeEl = row.querySelector('.light-location');
                    const levelSpan = row.querySelector('.light-level');

                    const name = nameEl ? nameEl.textContent : 'Lighting';
                    const place = placeEl ? placeEl.textContent : '';
                    const level = levelSpan ? levelSpan.textContent : '50';

                    dimLabel.textContent = `${name} · ${place}`;
                    dimSlider.value = level;
                    dimValue.textContent = `${level}%`;

                    dimModal.classList.remove('hidden');
                    dimModal.classList.add('flex');
                }
            });

            if (dimSlider && dimValue) {
                dimSlider.addEventListener('input', (e) => {
                    dimValue.textContent = `${e.target.value}%`;
                });
            }

            if (dimCancel && dimModal) {
                dimCancel.addEventListener('click', () => {
                    dimModal.classList.add('hidden');
                    dimModal.classList.remove('flex');
                    currentDimRow = null;
                });
            }

            if (dimApply && dimModal && dimSlider) {
                dimApply.addEventListener('click', () => {
                    if (currentDimRow) {
                        const levelSpan = currentDimRow.querySelector('.light-level');
                        const sliderVal = parseInt(dimSlider.value, 10) || 0;
                        if (levelSpan) {
                            levelSpan.textContent = sliderVal;
                            if (sliderVal > 0) currentDimRow.dataset.lastLevel = sliderVal;
                        }
                        refreshLightToggle(currentDimRow, sliderVal > 0);
                    }
                    dimModal.classList.add('hidden');
                    dimModal.classList.remove('flex');
                    currentDimRow = null;
                });
            }

            // CLIMATE +/- 0.5°C
            overviewRoot.addEventListener('click', (e) => {
                const tempUp = e.target.closest('.btn-temp-up');
                const tempDown = e.target.closest('.btn-temp-down');

                if (tempUp) adjustClimateTarget(tempUp, 0.5);
                if (tempDown) adjustClimateTarget(tempDown, -0.5);
            });

            overviewRoot.addEventListener('click', (e) => {
                const modeBtn = e.target.closest('.climate-mode-btn');
                if (!modeBtn) return;
                const row = modeBtn.closest('[data-climate-row]');
                const mode = modeBtn.dataset.mode;
                setClimateMode(row, mode);
            });

            overviewRoot.addEventListener('keydown', (e) => {
                if (e.key !== ' ' && e.key !== 'Enter') return;
                const toggle = e.target.closest('[data-light-toggle]');
                if (!toggle) return;
                e.preventDefault();
                const row = toggle.closest('[data-light-row]');
                const isCurrentlyOn = toggle.getAttribute('aria-checked') === 'true';
                updateLightState(row, !isCurrentlyOn);
            });

            climateRows.forEach(row => {
                if (!row.dataset.mode) row.dataset.mode = 'heat';
                updateClimateModeButtons(row);
                updateClimateStatus(row);
            });

            document.querySelectorAll('[data-light-row]').forEach(row => {
                const levelSpan = row.querySelector('.light-level');
                const stateSpan = row.querySelector('.light-state');
                let isOn = false;

                if (levelSpan) {
                    const level = parseInt(levelSpan.textContent, 10);
                    isOn = level > 0;
                    if (!Number.isNaN(level) && level > 0) {
                        row.dataset.lastLevel = level;
                    }
                } else if (stateSpan) {
                    isOn = stateSpan.textContent.trim().toUpperCase() === 'ON';
                }

                refreshLightToggle(row, isOn);
            });

            if (window.feather) feather.replace();
        });
    </script>
</body>
</html>
